const express = require('express');
const oauth2 = require('oauth2-client');

const app = express();

app.get('/authorize', (req, res) => {
  const client = new oauth2.Client({
    clientId: 'YOUR_CLIENT_ID',
    clientSecret: 'YOUR_CLIENT_SECRET',
    authorizeUrl: 'https://example.com/oauth/authorize',
    tokenUrl: 'https://example.com/oauth/token',
  });

  res.redirect(client.getAuthorizationUrl({
    redirect_uri: 'http://localhost:3000/callback',
  }));
});

app.get('/callback', (req, res) => {
  const client = new oauth2.Client({
    clientId: 'YOUR_CLIENT_ID',
    clientSecret: 'YOUR_CLIENT_SECRET',
    authorizeUrl: 'https://example.com/oauth/authorize',
    tokenUrl: 'https://example.com/oauth/token',
  });

  const token = client.exchange(req.query.code, {
    redirect_uri: 'http://localhost:3000/callback',
  });

  res.json(token);
});

app.listen(3000);
